wr1 <- wr(wd1)
plot(wr1, type="l")
wd1$D
length(which(wd1$D > 0)) / length(wd1$D)
95.70-16.97
getwd()
mclapply()
mclapply.hack()
install_github('kkdey/tmcmcR')
library(devtools)
install_github('kkdey/tmcmcR')
library(tmcmcR)
mclapply.hack()
rmc3()
tmcmcR:::mclapply.hack(1:4, function(x) return(x^2))
library(parallel)
tmcmcR:::mclapply.hack(1:4, function(x) return(x^2))
parallel:::mclapply(1:4, function(x) return(x^2))
parallel:::mclapply.hack(1:4, function(x) return(x^2))
tmcmcR:::mclapply.hack(1:4, function(x) return(x^2))
detectCores()
library(parallel)
library(parallel)
detectCores()
install.packages("Rmosek", type="source", repos="http://download.mosek.com/R/7")
install.packages("Rmosek", type="source", INSTALL_opts="--no-multiarch",
repos="http://download.mosek.com/R/7")
install.packages("Rmosek", repos="http://R-Forge.R-project.org", type="source", INSTALL_opts="--no-multiarch", configure.vars="PKG_MOSEKHOME=/Users/kushal/Documents/mosek/7/tools/platform/osx64x86 PKG_MOSEKLIB=mosek")
install.packages("Rmosek", repos="http://R-Forge.R-project.org", type="source", INSTALL_opts="--no-multiarch", configure.vars="PKG_MOSEKHOME=/Users/kushal/Documents/mosek/7/tools/platform/osx64x86 PKG_MOSEKLIB=mosek64")
getwd()
setwd('/Users/kushal/Documents/singleCell-method/project/analysis/')
setwd('/Users/kushal/Documents/singleCell-method/project/analysis/')
reads <- data.frame(fread('../data/Deng cell data/Deng_cell_data.txt'),row.names=1);
files <- list.files("../data/Deng_data/");
cell_meta <- unlist(lapply(files, function(x) strsplit(x,"_")[[1]][2]));
cell_meta[grep("zy",cell_meta)]="zy";
cell_meta[grep("smartseq2", files)]="8cell";
cell_meta[grep("8cell_2pooled", files)]="8cell";
cell_meta[grep("8cell_split", files)]="8cell";
cell_meta[grep("16cell_2pooled", files)]="16cell";
cell_meta[grep("16cell_split", files)]="16cell";
indices_not_reqd <- which(cell_meta=="BXC"   | cell_meta=="C57twocell" | cell_meta=="fibroblast");
cell_meta <- cell_meta[-indices_not_reqd];
reads <- reads[,-indices_not_reqd];
cell_meta_unique <- c("zy","early2cell","mid2cell","late2cell","4cell","8cell","16cell","earlyblast","midblast","lateblast") ;
order_of_development <- order(match(cell_meta,cell_meta_unique))
reads <- reads[,order_of_development];
cell_meta <- cell_meta[order_of_development]
colnames(reads) <- cell_meta;
setwd('/Users/kushal/Documents/singleCell-method/project/analysis/')
library(data.table)
reads <- data.frame(fread('../data/Deng cell data/Deng_cell_data.txt'),row.names=1);
files <- list.files("../data/Deng_data/");
cell_meta <- unlist(lapply(files, function(x) strsplit(x,"_")[[1]][2]));
cell_meta[grep("zy",cell_meta)]="zy";
cell_meta[grep("smartseq2", files)]="8cell_nd";
cell_meta[grep("8cell_2pooled", files)]="8cell_nd";
cell_meta[grep("8cell_split", files)]="8cell_nd";
cell_meta[grep("16cell_2pooled", files)]="16cell_nd";
cell_meta[grep("16cell_split", files)]="16cell_nd";
indices_not_reqd <- which(cell_meta=="BXC"   | cell_meta=="C57twocell" | cell_meta=="fibroblast" | cell_meta =="8cell_nd" | cell_meta == "16cell_nd");
dim(reads)
cell_meta <- cell_meta[-indices_not_reqd];
summary(cell_meta)
unique(cell_meta)
length(cell_meta)
reads <- reads[,-indices_not_reqd];
cell_meta_unique <- c("zy","early2cell","mid2cell","late2cell","4cell","8cell","16cell","earlyblast","midblast","lateblast") ;
order_of_development <- order(match(cell_meta,cell_meta_unique))
reads <- reads[,order_of_development];
cell_meta <- cell_meta[order_of_development]
colnames(reads) <- cell_meta;
dim(reads)
samp_metadata <- cbind.data.frame(cell_meta);
counts <- t(reads);
colnames(samp_metadata) <- c("dev_phase");
StructureObj(as.matrix(counts),nclus_vec,samp_metadata = samp_metadata, tol=0.01, batch_lab = NULL, path_rda="../../project/rdas/deng_topic_fit.rda",partition=c('TRUE'),path_struct = "../figures/deng_structure");
deng_topics <- get(load("../../project/rdas/deng_topic_fit.rda"));
library(CountClust)
StructureObj(as.matrix(counts),nclus_vec,samp_metadata = samp_metadata, tol=0.01, batch_lab = NULL, path_rda="../../project/rdas/deng_topic_fit.rda",partition=c('TRUE'),path_struct = "../figures/deng_structure");
deng_topics <- get(load("../../project/rdas/deng_topic_fit.rda"));
nclus_vec <- 2:7;
StructureObj(as.matrix(counts),nclus_vec,samp_metadata = samp_metadata, tol=0.01, batch_lab = NULL, path_rda="../../project/rdas/deng_topic_fit.rda",partition=c('TRUE'),path_struct = "../figures/deng_structure");
StructureObj(as.matrix(counts),nclus_vec,samp_metadata = samp_metadata, tol=10, batch_lab = NULL, path_rda="../../project/rdas/deng_topic_fit.rda",partition=c('TRUE'),path_struct = "../figures/deng_structure");
install.packages("maptpx")
install.packages("maptpx")
library(maptpx)
StructureObj(as.matrix(counts),nclus_vec,samp_metadata = samp_metadata, tol=10, batch_lab = NULL, path_rda="../../project/rdas/deng_topic_fit.rda",partition=c('TRUE'),path_struct = "../figures/deng_structure");
deng_topics <- get(load("../../project/rdas/deng_topic_fit.rda"));
path_struct = "../figures/deng_structure"
num <- 1
metadata <- samp_metadata[,num];
deng_topics <- get(load("../../project/rdas/deng_topic_fit.rda"));
for(nclus in 1:length(nclus_vec)){
docweights <- deng_topics[[nclus]]$omega[-indices_not_reqd,];
docweights <- docweights[order_of_development,]
if(!dir.exists(paste0(path_struct,"/clus_",dim(docweights)[2])))
dir.create(paste0(path_struct,"/clus_",dim(docweights)[2]))
control.default <- list(struct.width=600, struct.height=400, cex.axis=1, cex.main=1.5, las=2, lwd=3,mar.bottom =14, mar.left=2, mar.top=2, mar.right=2,color=2:(dim(docweights)[2]+1));
control <- control.default;
struct.width <- control$struct.width;
struct.height <- control$struct.height;
cex.axis <- control$cex.axis;
cex.main <- control$cex.main;
las <- control$las;
lwd <- control$lwd;
mar.bottom <- control$mar.bottom;
mar.left <- control$mar.left;
mar.top <- control$mar.top;
mar.right <- control$mar.right;
color <- control$color;
png(filename=paste0(path_struct,'/clus_',dim(docweights)[2],'/struct_clus_',dim(docweights)[2],'_',colnames(samp_metadata)[num],'.png'),width=struct.width, height=struct.height);
par(mar=c(mar.bottom,mar.left, mar.top,mar.right))
barplot(t(docweights),col=color,axisnames=F,space=0,border=NA,
main=paste("Structure arranged by",colnames(samp_metadata)[num],": topics=",(nclus)),
las=las,ylim=c(0,1),ylab="admix prop", xlab=paste0(colnames(samp_metadata)[num]),
cex.axis=cex.axis,cex.main=cex.main);
labels = match(unique(metadata), metadata);
abline(v=labels-1, lty=1, lwd=lwd)
labels_low=labels-1;
labels_up=c(labels_low[2:length(labels_low)],dim(docweights)[1]);
mid_point <- labels_low +0.5*(labels_up-labels_low);
axis(1,at=mid_point, unique(metadata),las=las,cex.axis=cex.axis,lwd=lwd);
dev.off()
}
deng_topics[[1]]
deng_topics[[1]]$omega
dim(deng_topics[[1]]$omega)
dim(deng_topics[[7]]$omega)
dim(deng_topics[[6]]$omega)
cell_meta
for(nclus in 1:length(nclus_vec)){
docweights <- deng_topics[[nclus]]$omega;
if(!dir.exists(paste0(path_struct,"/clus_",dim(docweights)[2])))
dir.create(paste0(path_struct,"/clus_",dim(docweights)[2]))
control.default <- list(struct.width=600, struct.height=400, cex.axis=1, cex.main=1.5, las=2, lwd=3,mar.bottom =14, mar.left=2, mar.top=2, mar.right=2,color=2:(dim(docweights)[2]+1));
control <- control.default;
struct.width <- control$struct.width;
struct.height <- control$struct.height;
cex.axis <- control$cex.axis;
cex.main <- control$cex.main;
las <- control$las;
lwd <- control$lwd;
mar.bottom <- control$mar.bottom;
mar.left <- control$mar.left;
mar.top <- control$mar.top;
mar.right <- control$mar.right;
color <- control$color;
png(filename=paste0(path_struct,'/clus_',dim(docweights)[2],'/struct_clus_',dim(docweights)[2],'_',colnames(samp_metadata)[num],'.png'),width=struct.width, height=struct.height);
par(mar=c(mar.bottom,mar.left, mar.top,mar.right))
barplot(t(docweights),col=color,axisnames=F,space=0,border=NA,
main=paste("Structure arranged by",colnames(samp_metadata)[num],": topics=",(nclus)),
las=las,ylim=c(0,1),ylab="admix prop", xlab=paste0(colnames(samp_metadata)[num]),
cex.axis=cex.axis,cex.main=cex.main);
labels = match(unique(metadata), metadata);
abline(v=labels-1, lty=1, lwd=lwd)
labels_low=labels-1;
labels_up=c(labels_low[2:length(labels_low)],dim(docweights)[1]);
mid_point <- labels_low +0.5*(labels_up-labels_low);
axis(1,at=mid_point, unique(metadata),las=las,cex.axis=cex.axis,lwd=lwd);
dev.off()
}
dim(docweights)[2]+1
control$color
color
nclus
for(nclus in 1:length(nclus_vec)){
docweights <- deng_topics[[nclus]]$omega;
if(!dir.exists(paste0(path_struct,"/clus_",dim(docweights)[2])))
dir.create(paste0(path_struct,"/clus_",dim(docweights)[2]))
control.default <- list(struct.width=600, struct.height=400, cex.axis=1, cex.main=1.5, las=2, lwd=3,mar.bottom =14, mar.left=2, mar.top=2, mar.right=2,color=2:(dim(docweights)[2]+1));
control <- control.default;
struct.width <- control$struct.width;
struct.height <- control$struct.height;
cex.axis <- control$cex.axis;
cex.main <- control$cex.main;
las <- control$las;
lwd <- control$lwd;
mar.bottom <- control$mar.bottom;
mar.left <- control$mar.left;
mar.top <- control$mar.top;
mar.right <- control$mar.right;
color <- control$color;
png(filename=paste0(path_struct,'/clus_',dim(docweights)[2],'/struct_clus_',dim(docweights)[2],'_',colnames(samp_metadata)[num],'.png'),width=struct.width, height=struct.height);
par(mar=c(mar.bottom,mar.left, mar.top,mar.right))
barplot(t(docweights),col=color,axisnames=F,space=0,border=NA,
main=paste("Structure arranged by",colnames(samp_metadata)[num],": topics=",(nclus+1)),
las=las,ylim=c(0,1),ylab="admix prop", xlab=paste0(colnames(samp_metadata)[num]),
cex.axis=cex.axis,cex.main=cex.main);
labels = match(unique(metadata), metadata);
abline(v=labels-1, lty=1, lwd=lwd)
labels_low=labels-1;
labels_up=c(labels_low[2:length(labels_low)],dim(docweights)[1]);
mid_point <- labels_low +0.5*(labels_up-labels_low);
axis(1,at=mid_point, unique(metadata),las=las,cex.axis=cex.axis,lwd=lwd);
dev.off()
}
setwd('/Users/kushal/Documents/singleCell-method/project/analysis/')
library(data.table)
reads <- data.frame(fread('../data/Deng cell data/Deng_cell_data.txt'),row.names=1);
files <- list.files("../data/Deng_data/");
cell_meta <- unlist(lapply(files, function(x) strsplit(x,"_")[[1]][2]));
unique(cell_meta)
cell_meta <- unlist(lapply(files, function(x) strsplit(x,"_")[[1]][2]));
files
cell_meta <- unlist(lapply(files, function(x) strsplit(x,"_")[[1]][2]));
cell_meta[grep("zy",cell_meta)]="zy";
cell_meta[grep("smartseq2", files)]="8cell_nd";
cell_meta[grep("8cell_2pooled", files)]="8cell_nd";
cell_meta[grep("8cell_split", files)]="8cell_nd";
cell_meta[grep("16cell_2pooled", files)]="16cell_nd";
cell_meta[grep("16cell_split", files)]="16cell_nd";
unique(cell_meta)
indices_not_reqd <- which(cell_meta=="BXC"   | cell_meta=="C57twocell" | cell_meta=="fibroblast" | cell_meta =="8cell_nd" | cell_meta == "16cell_nd");
cell_meta <- cell_meta[-indices_not_reqd];
unique(cell_meta)
files[grep("16cell_2pooled", files)]
files[grep("16cell", files)]
setwd('/Users/kushal/Documents/count-clustering/src/')
library(data.table)
cis_data <- data.frame(fread('../data/GTEX_V6/cis_gene_expression.txt'));
dim(cis_data)
cis_data[1:5,1:5]
samples_id=read.table("../data/GTEX_V6/samples_id.txt")[,3];
samples_id=read.table("../data/GTEX_V6/samples_id.txt")[,3];
samples_id
new_data <- cis_data[,-(1:2)];
dim(new_data)
new_data <- cis_data[,-(1:2)];
rownames(new_data) <- cis_data[,2];
new_data[1:5,1:5]
cis_data[1:5,1:5]
framed_data <- cbind(t(new_data), samples_id);
dim(framed_data)
tail(colnames(framed_data))
df <- framed_data %>% group_by(samples_id) %>% summarise_each(funs(sum))
library(dplyr)
install.packages("dplyr")
library(dplyr)
df <- framed_data %>% group_by(samples_id) %>% summarise_each(funs(sum))
framed_data <- as.data.frame(framed_data);
df <- framed_data %>% group_by(samples_id) %>% summarise_each(funs(sum))
framed_data <- data.frame(framed_data);
dim(framed_data)
df_temp <- framed_data[,c(1:5,16070)];
dim(df_temp)
framed_data <- cbind(t(new_data), samples_id);
framed_data <- data.frame(framed_data);
df_temp <- framed_data[,c(1:15,16070)];
dim(df_temp)
df_temp
new_data <- cis_data[,-(1:2)];
rownames(new_data) <- cis_data[,2];
framed_data <- t(new_data);
framed_data <- data.frame(framed_data);
df_temp <- cbind(framed_data[,1:15], samples_id);
df_temp
df <- df_temp %>% group_by(samples_id) %>% summarise_each(funs(sum))
df
data.frame.df <- data.frame(df);
dim(data.frame.df)
data.frame.df[1:5,1:6]
cis_data <- data.frame(fread('../data/GTEX_V6/cis_gene_expression.txt'));
samples_id=read.table("../data/GTEX_V6/samples_id.txt")[,3];
new_data <- cis_data[,-(1:2)];
rownames(new_data) <- cis_data[,2];
framed_data <- t(new_data);
library(dplyr)
framed_data <- data.frame(framed_data);
df_temp <- cbind(framed_data, samples_id);
df <- df_temp %>% group_by(samples_id) %>% summarise_each(funs(sum))
data.frame.df <- data.frame(df);
dim(data.frame.df)
data.frame.df[1:5,1:5]
wriet.table(data.frame.df, '../data/GTEX_V6/cis_gene_counts_tissuelevel.txt')
write.table(data.frame.df, '../data/GTEX_V6/cis_gene_counts_tissuelevel.txt')
frame <- read.table("../data/GTEX_V6/cis_gene_counts_tissuelevel.txt")
frame[1:5,1:10]
dim(frame)
library(tsne)
library(qtlcharts)
topics_theta <- data.frame(fread("../external_data/GTEX_V6/admix_out_GTEX_V6/theta_cis_genes_0_1_2.txt"))[,-1];
topics_theta <- data.frame(fread("../external_data/GTEX_V6/admix_out_GTEX_V6/theta_cis_genes_0_1_2.txt"))[,-1];
library(maptpx)
library(qtlcharts)
library(data.table)
library(mygene)
source("https://bioconductor.org/biocLite.R")
biocLite("mygene")
library(mygene)
topics_theta <- data.frame(fread("../external_data/GTEX_V6/admix_out_GTEX_V6/theta_cis_genes_0_1_2.txt"))[,-1];
dim(topics_theta)
barplot(rep(1,15),col=1:15)
barplot(rep(1,15),col=2:16)
barplot(rep(1,15),col=color[1:15])
axis(1:15, at=1:15)
axis(1:15, at=1:18)
axis(1:15, at=0.5:17.5)
axis(1:15, at=0.5:18.5)
barplot(rep(1,15),col=color[1:15])
axis(1:15, at=0.5:18.5)
barplot(rep(1,15),col=color[1:15])
axis(1:15, at=0.5:18)
rm(list=ls())
library(data.table)
#install_github('kkdey/maptpx')
library(maptpx)
library(CountClust)
library(data.table)
reads <- data.frame(fread('../external_data/Deng_Data/Deng_cell_data.txt'),row.names=1);
files <- list.files("../external_data/Deng_Data/Deng_files/");
cell_meta <- unlist(lapply(files, function(x) strsplit(x,"_")[[1]][2]));
embryo_id <- unlist(lapply(files, function(x) strsplit(strsplit(x,"_")[[1]][3],"-")[[1]][1]));
cell_meta[grep("zy",cell_meta)]="zy";
cell_meta[grep("smartseq2", files)]="8cell_nd";
cell_meta[grep("8cell_2pooled", files)]="8cell_nd";
cell_meta[grep("8cell_split", files)]="8cell_nd";
cell_meta[grep("16cell_2pooled", files)]="16cell_nd";
cell_meta[grep("16cell_split", files)]="16cell_nd";
indices_not_reqd <- which(cell_meta=="BXC"   | cell_meta=="C57twocell" | cell_meta=="fibroblast" | cell_meta =="8cell_nd" | cell_meta == "16cell_nd");
cell_meta <- cell_meta[-indices_not_reqd];
embryo_id <- embryo_id[-indices_not_reqd];
embryo_id[which(embryo_id == "expression.txt")]="."
cell_embryo <- paste0(cell_meta,"_", embryo_id);
reads <- reads[,-indices_not_reqd];
cell_meta_unique <- c("zy","early2cell","mid2cell","late2cell","4cell","8cell","16cell","earlyblast","midblast","lateblast") ;
order_of_development <- order(match(cell_meta,cell_meta_unique))
reads <- reads[,order_of_development];
cell_meta <- cell_meta[order_of_development]
cell_embryo <- cell_embryo[order_of_development];
colnames(reads) <- cell_meta;
samp_metadata <- cbind.data.frame(cell_meta, cell_embryo);
counts <- t(reads);
colnames(samp_metadata) <- c("dev_phase", "dev.phase_embryo");
nclus <- 6
if(file.exists("../rdas/deng_topic_fit.rda")) {
deng_topics <- get(load("../rdas/deng_topic_fit.rda"));
} else {
StructureObj(as.matrix(counts),nclus_vec,samp_metadata = samp_metadata, tol=10, batch_lab = NULL, path_rda="../rdas/deng_topic_fit.rda",partition=c('TRUE'),path_struct = "../plots/deng_structure");
deng_topics <- get(load("../rdas/deng_topic_fit.rda"));
}
cell_meta
unique(cell_meta)
index_of_zoom <- which(cell_meta=="4cell" || cell_meta=="8cell" || cell_meta=="16cell");
index_of_zoom
index_of_zoom <- which(cell_meta=="4cell" | cell_meta=="8cell" | cell_meta=="16cell");
index_of_zoom
length(deng_topics)
omega <- deng_topics[[5]]$omega;
dim(omega)
omega <- omega[index_of_zoom,];
dim(omega)
samp_metadata <- samp_metadata[index_of_zoom,];
samp_metadata
colnames(samp_metadata) <- c("dev_phase_zoom", "dev.phase_embryo_zoom");
samp_metadata[1:5,]
docweights <- omega
path_struct = "../plots/deng_structure"
if(!dir.exists(paste0(path_struct,"/clus_",dim(docweights)[2])))
dir.create(paste0(path_struct,"/clus_",dim(docweights)[2]))
control.default <- list(struct.width=600, struct.height=400, cex.axis=1, cex.main=1.5, las=2, lwd=3,mar.bottom =14, mar.left=2, mar.top=2, mar.right=2,color=2:(dim(docweights)[2]+1));
control <- control.default;
struct.width <- control$struct.width;
struct.height <- control$struct.height;
cex.axis <- control$cex.axis;
cex.main <- control$cex.main;
las <- control$las;
lwd <- control$lwd;
mar.bottom <- control$mar.bottom;
mar.left <- control$mar.left;
mar.top <- control$mar.top;
mar.right <- control$mar.right;
color <- control$color;
png(filename=paste0(path_struct,'/clus_',,'/struct_clus_',nclus,'_',colnames(samp_metadata)[num],'.png'),width=struct.width, height=struct.height);
par(mar=c(mar.bottom,mar.left, mar.top,mar.right))
barplot(t(docweights),col=color,axisnames=F,space=0,border=NA,
main=paste("Structure arranged by",colnames(samp_metadata)[num],": topics=",(nclus+1)),
las=las,ylim=c(0,1),ylab="admix prop", xlab=paste0(colnames(samp_metadata)[num]),
cex.axis=cex.axis,cex.main=cex.main);
labels = match(unique(metadata), metadata);
abline(v=labels-1, lty=1, lwd=lwd)
labels_low=labels-1;
labels_up=c(labels_low[2:length(labels_low)],dim(docweights)[1]);
mid_point <- labels_low +0.5*(labels_up-labels_low);
axis(1,at=mid_point, unique(metadata),las=las,cex.axis=cex.axis,lwd=lwd);
dev.off()
docweights <- omega
num <- 2
path_struct = "../plots/deng_structure"
if(!dir.exists(paste0(path_struct,"/clus_",dim(docweights)[2])))
dir.create(paste0(path_struct,"/clus_",dim(docweights)[2]))
control.default <- list(struct.width=600, struct.height=400, cex.axis=1, cex.main=1.5, las=2, lwd=3,mar.bottom =14, mar.left=2, mar.top=2, mar.right=2,color=2:(dim(docweights)[2]+1));
control <- control.default;
struct.width <- control$struct.width;
struct.height <- control$struct.height;
cex.axis <- control$cex.axis;
cex.main <- control$cex.main;
las <- control$las;
lwd <- control$lwd;
mar.bottom <- control$mar.bottom;
mar.left <- control$mar.left;
mar.top <- control$mar.top;
mar.right <- control$mar.right;
color <- control$color;
png(filename=paste0(path_struct,'/clus_',,'/struct_clus_',nclus,'_',colnames(samp_metadata)[num],'.png'),width=struct.width, height=struct.height);
par(mar=c(mar.bottom,mar.left, mar.top,mar.right))
barplot(t(docweights),col=color,axisnames=F,space=0,border=NA,
main=paste("Structure arranged by",colnames(samp_metadata)[num],": topics=",(nclus+1)),
las=las,ylim=c(0,1),ylab="admix prop", xlab=paste0(colnames(samp_metadata)[num]),
cex.axis=cex.axis,cex.main=cex.main);
labels = match(unique(metadata), metadata);
abline(v=labels-1, lty=1, lwd=lwd)
labels_low=labels-1;
labels_up=c(labels_low[2:length(labels_low)],dim(docweights)[1]);
mid_point <- labels_low +0.5*(labels_up-labels_low);
axis(1,at=mid_point, unique(metadata),las=las,cex.axis=cex.axis,lwd=lwd);
dev.off()
docweights <- omega
num <- 2
metadata <- samp_metadata[,num];
path_struct = "../plots/deng_structure"
if(!dir.exists(paste0(path_struct,"/clus_",dim(docweights)[2])))
dir.create(paste0(path_struct,"/clus_",dim(docweights)[2]))
control.default <- list(struct.width=600, struct.height=400, cex.axis=1, cex.main=1.5, las=2, lwd=3,mar.bottom =14, mar.left=2, mar.top=2, mar.right=2,color=2:(dim(docweights)[2]+1));
control <- control.default;
struct.width <- control$struct.width;
struct.height <- control$struct.height;
cex.axis <- control$cex.axis;
cex.main <- control$cex.main;
las <- control$las;
lwd <- control$lwd;
mar.bottom <- control$mar.bottom;
mar.left <- control$mar.left;
mar.top <- control$mar.top;
mar.right <- control$mar.right;
color <- control$color;
png(filename=paste0(path_struct,'/clus_',,'/struct_clus_',nclus,'_',colnames(samp_metadata)[num],'.png'),width=struct.width, height=struct.height);
par(mar=c(mar.bottom,mar.left, mar.top,mar.right))
barplot(t(docweights),col=color,axisnames=F,space=0,border=NA,
main=paste("Structure arranged by",colnames(samp_metadata)[num],": topics=",(nclus+1)),
las=las,ylim=c(0,1),ylab="admix prop", xlab=paste0(colnames(samp_metadata)[num]),
cex.axis=cex.axis,cex.main=cex.main);
labels = match(unique(metadata), metadata);
abline(v=labels-1, lty=1, lwd=lwd)
labels_low=labels-1;
labels_up=c(labels_low[2:length(labels_low)],dim(docweights)[1]);
mid_point <- labels_low +0.5*(labels_up-labels_low);
axis(1,at=mid_point, unique(metadata),las=las,cex.axis=cex.axis,lwd=lwd);
dev.off()
docweights <- omega
num <- 2
metadata <- samp_metadata[,num];
path_struct = "../plots/deng_structure"
if(!dir.exists(paste0(path_struct,"/clus_",dim(docweights)[2])))
dir.create(paste0(path_struct,"/clus_",dim(docweights)[2]))
control.default <- list(struct.width=600, struct.height=400, cex.axis=1, cex.main=1.5, las=2, lwd=3,mar.bottom =14, mar.left=2, mar.top=2, mar.right=2,color=2:(dim(docweights)[2]+1));
control <- control.default;
struct.width <- control$struct.width;
struct.height <- control$struct.height;
cex.axis <- control$cex.axis;
cex.main <- control$cex.main;
las <- control$las;
lwd <- control$lwd;
mar.bottom <- control$mar.bottom;
mar.left <- control$mar.left;
mar.top <- control$mar.top;
mar.right <- control$mar.right;
color <- control$color;
png(filename=paste0(path_struct,'/clus_',nclus,'/struct_clus_',nclus,'_',colnames(samp_metadata)[num],'.png'),width=struct.width, height=struct.height);
par(mar=c(mar.bottom,mar.left, mar.top,mar.right))
barplot(t(docweights),col=color,axisnames=F,space=0,border=NA,
main=paste("Structure arranged by",colnames(samp_metadata)[num],": topics=",(nclus+1)),
las=las,ylim=c(0,1),ylab="admix prop", xlab=paste0(colnames(samp_metadata)[num]),
cex.axis=cex.axis,cex.main=cex.main);
labels = match(unique(metadata), metadata);
abline(v=labels-1, lty=1, lwd=lwd)
labels_low=labels-1;
labels_up=c(labels_low[2:length(labels_low)],dim(docweights)[1]);
mid_point <- labels_low +0.5*(labels_up-labels_low);
axis(1,at=mid_point, unique(metadata),las=las,cex.axis=cex.axis,lwd=lwd);
dev.off()
docweights <- omega
num <- 2
metadata <- samp_metadata[,num];
path_struct = "../plots/deng_structure"
if(!dir.exists(paste0(path_struct,"/clus_",dim(docweights)[2])))
dir.create(paste0(path_struct,"/clus_",dim(docweights)[2]))
control.default <- list(struct.width=600, struct.height=400, cex.axis=1, cex.main=1.5, las=2, lwd=3,mar.bottom =14, mar.left=2, mar.top=2, mar.right=2,color=2:(dim(docweights)[2]+1));
control <- control.default;
struct.width <- control$struct.width;
struct.height <- control$struct.height;
cex.axis <- control$cex.axis;
cex.main <- control$cex.main;
las <- control$las;
lwd <- control$lwd;
mar.bottom <- control$mar.bottom;
mar.left <- control$mar.left;
mar.top <- control$mar.top;
mar.right <- control$mar.right;
color <- control$color;
png(filename=paste0(path_struct,'/clus_',nclus,'/struct_clus_',nclus,'_',colnames(samp_metadata)[num],'.png'),width=struct.width, height=struct.height);
par(mar=c(mar.bottom,mar.left, mar.top,mar.right))
barplot(t(docweights),col=color,axisnames=F,space=0,border=NA,
las=las,ylim=c(0,1),ylab="admix prop", xlab=paste0(colnames(samp_metadata)[num]),
cex.axis=cex.axis,cex.main=cex.main);
labels = match(unique(metadata), metadata);
abline(v=labels-1, lty=1, lwd=lwd)
labels_low=labels-1;
labels_up=c(labels_low[2:length(labels_low)],dim(docweights)[1]);
mid_point <- labels_low +0.5*(labels_up-labels_low);
axis(1,at=mid_point, unique(metadata),las=las,cex.axis=cex.axis,lwd=lwd);
dev.off()
