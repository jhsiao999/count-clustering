net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_OS, sm="IRR")
net1
netheat(net1)
netgraph(net1, points=TRUE, cex.points=3, cex=1.25)
forest(net1)
netmeasures1 <netmeasures(net1);
netmeasures1 <- netmeasures(net1);
netmeasures1
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_OS, sm="RR")
summary(net1)
forest(net1,pooled="random")
forest(net1,pooled)
forest(net1)
forest(net1,reference.group = 'MRD')
netgraph(net1, highlight = "MRD")
netgraph(net1, thickness="equal")
netgraph(net1, thickness="equal", iterate=TRUE)
netgraph(net1, thickness="w.fixed")
netgraph(net1, thickness="w.fixed", start.layout = "circle")
netgraph(net1, thickness="w.fixed", start.layout = "circle",plastic=TRUE)
netgraph(net1, thickness="w.fixed", start.layout = "circle",plastic=FALSE)
netgraph(net1, thickness="w.fixed", start.layout = "circle",plastic=FALSE, col.points="red")
netgraph(net1, thickness="w.fixed", start.layout = "circle",plastic=FALSE, col="red",)
forest(net1,reference.group = 'MRD')
netgraph(net1, thickness="w.fixed", start.layout = "circle",plastic=FALSE, col="red",)
forest(net1,reference.group = 'MRD')
netgraph(net1, thickness="w.fixed", plastic=FALSE, col="red",start="eigen", col.multiarm="purple")
netgraph(net1, thickness="w.fixed", plastic=FALSE, col="red",start="prcomp", col.multiarm="purple")
netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="random", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
data_DFS <- data[which(as.character(effect)=="DFS"),];
p_DFS <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_OS)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_DFS, sm="RR")
summary(net1)
netmeasures1 <- netmeasures(net1);
netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_DFS <- data[which(as.character(effect)=="DFS"),];
p_DFS <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_DFS)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_DFS, sm="RR")
summary(net1)
netmeasures1 <- netmeasures(net1);
netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_Engraftment <- data[which(as.character(effect)=="Engraftment"),];
p_Engraftment <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_Engraftment)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_Engraftment, sm="RR")
summary(net1)
netmeasures1 <- netmeasures(net1);
netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_aGVHD <- data[which(as.character(effect)=="aGVHD"),];
p_aGVHD <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_aGVHD)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_aGVHD, sm="RR")
summary(net1)
netmeasures1 <- netmeasures(net1);
netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_cGVHD <- data[which(as.character(effect)=="cGVHD"),];
p_cGVHD <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_cGVHD)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_cGVHD, sm="RR")
summary(net1)
netmeasures1 <- netmeasures(net1);
netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_TRM <- data[which(as.character(effect)=="TRM"),];
p_TRM <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_TRM)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_TRM, sm="RR")
summary(net1)
netmeasures1 <- netmeasures(net1);
netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
par(mfrow=c(3,2))
data_OS <- data[which(as.character(effect)=="OS"),];
p_OS <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_OS)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_OS, sm="RR")
summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_DFS <- data[which(as.character(effect)=="DFS"),];
p_DFS <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_DFS)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_DFS, sm="RR")
summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_Engraftment <- data[which(as.character(effect)=="Engraftment"),];
p_Engraftment <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_Engraftment)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_Engraftment, sm="RR")
summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_aGVHD <- data[which(as.character(effect)=="aGVHD"),];
p_aGVHD <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_aGVHD)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_aGVHD, sm="RR")
summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_cGVHD <- data[which(as.character(effect)=="cGVHD"),];
p_cGVHD <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_cGVHD)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_cGVHD, sm="RR")
summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_TRM <- data[which(as.character(effect)=="TRM"),];
p_TRM <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_TRM)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_TRM, sm="RR")
summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
par(mfrow=c(3,2))
data_OS <- data[which(as.character(effect)=="OS"),];
p_OS <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_OS)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_OS, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_DFS <- data[which(as.character(effect)=="DFS"),];
p_DFS <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_DFS)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_DFS, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_Engraftment <- data[which(as.character(effect)=="Engraftment"),];
p_Engraftment <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_Engraftment)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_Engraftment, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_aGVHD <- data[which(as.character(effect)=="aGVHD"),];
p_aGVHD <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_aGVHD)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_aGVHD, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_cGVHD <- data[which(as.character(effect)=="cGVHD"),];
p_cGVHD <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_cGVHD)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_cGVHD, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_TRM <- data[which(as.character(effect)=="TRM"),];
p_TRM <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_TRM)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_TRM, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
par(mfrow=c(3,1))
data_OS <- data[which(as.character(effect)=="OS"),];
p_OS <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_OS)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_OS, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_DFS <- data[which(as.character(effect)=="DFS"),];
p_DFS <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_DFS)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_DFS, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_Engraftment <- data[which(as.character(effect)=="Engraftment"),];
p_Engraftment <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_Engraftment)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_Engraftment, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_aGVHD <- data[which(as.character(effect)=="aGVHD"),];
p_aGVHD <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_aGVHD)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_aGVHD, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_cGVHD <- data[which(as.character(effect)=="cGVHD"),];
p_cGVHD <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_cGVHD)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_cGVHD, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
data_TRM <- data[which(as.character(effect)=="TRM"),];
p_TRM <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_TRM)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_TRM, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,reference.group = 'MRD')
par(mfrow=c(3,1))
forest(net1,reference.group = 'MRD')
p_DFS <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data)
forest()
forest
UseMethod("forest")
forest.netmata
forest.netmata()
p_OS <- pairwise(treat = list(as.character(treat1), as.character(treat2)),
event = list(as.numeric(as.vector(events1)), as.numeric(as.vector(events2))),
n = list(as.numeric(as.vector(total1)), as.numeric(as.vector(total2))),
studlab=as.factor(ID),
data=data_OS)
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_OS, sm="RR")
#summary(net1)
#netmeasures1 <- netmeasures(net1);
#netgraph(net1, thickness="w.fixed", plastic=TRUE, col="red",start="circle", col.multiarm="purple")
forest(net1,annotate=T, addfit=T,addcred=T,reference.group = 'MRD')
net1 <- netmeta(TE, seTE, treat1, treat2, studlab, data=p_OS, sm="RR",pooled="random")
forest(net1,pooled=ifelse(x$comb.random, "random", "fixed"),annotate=T, addfit=T,addcred=T,reference.group = 'MRD')
forest(net1,annotate=T, addfit=T,addcred=T,reference.group = 'MRD')
forest(net1,reference.group = 'MRD',leftcols="studlab")
forest(net1,reference.group = 'MRD',leftcols="studlab")
forest(net1,reference.group = 'MRD',leftcols="studlab",rightcols=NULL)
forest(net1,reference.group = 'MRD',leftcols="studlab",rightcols=NULL,
leftlabs="Contrast to MRD")
forest(net1,reference.group = 'MRD',leftcols="studlab",rightcols=NULL,
leftlabs="ratio to MRD")
forest(net1,reference.group = 'MRD',leftcols="studlab",rightcols=NULL,
leftlabs="comparison wrt MRD")
forest(net1,reference.group = 'MRD',leftcols="studlab",rightcols=NULL,
leftlabs="treatments")
par(mfrow=c(3,1))
forest(net1,reference.group = 'MRD',leftcols="studlab",rightcols=NULL,
leftlabs="treatments")
par(mfrow=c(1,2))
forest(net1,reference.group = 'MRD',leftcols="studlab",rightcols=NULL,
leftlabs="treatments")
par(mfrow=c(1,1))
forest(net1,reference.group = 'MRD',leftcols="studlab",rightcols=NULL,
leftlabs="treatments")
getwd()
#suppressMessages(suppressWarnings(library(Seurat)))
suppressMessages(suppressWarnings(library(maptpx)))
suppressMessages(suppressWarnings(library(slam)))
suppressMessages(suppressWarnings(library(tsne)))
#suppressMessages(suppressWarnings(library(devtools)))
suppressMessages(suppressWarnings(library(Rtsne)))
suppressMessages(suppressWarnings(library(qtlcharts)))
library(cluster)
suppressMessages(suppressWarnings(library(vegan)))
suppressMessages(suppressWarnings(library(gplots)))
data=read.csv("../external_data/Himalayan_grid_matrix.csv",header=TRUE);
counts=as.matrix(data[,-1]);
rownames(counts)=data[,1];
counts[1:5,1:5]
new_data1 <- data.frame(read.csv('../external_data/MohanGrids.csv'));
new_data2 <- data.frame(read.csv('../external_data/MohanGrids2.csv'));
bird_species <- union(as.vector(colnames(data)), union(as.vector(new_data1[,1]), as.vector(new_data2[,1])));
new_data <- matrix(0,dim(counts)[1]+3,length(bird_species));
new_data[1,match(new_data1[,1],bird_species)]=new_data1[,2];
new_data[2,match(new_data1[,1],bird_species)]=new_data1[,3];
new_data[3,match(new_data2[,1],bird_species)]=new_data2[,2];
new_data[4:(dim(counts)[1]+3),match(colnames(counts),bird_species)]=counts;
new_counts <- as.matrix(new_data);
rownames(new_counts) <- c(c("U1","U2","MA1"),rownames(counts));
dim(new_counts)
colnames(new_counts)
new_counts[1:5,1:5]
length(bird_species)
bodymass <- read.csv('../external_data//massKushal.csv');
dim(bodymass)
bodymass[1:10,]
bodymass[1,]
bodymass_val <- bodymass_data[,2];
bodymass_birds <- bodymass_data[,1];
match(bird_species,bodymass_birds)
bodymass_data <- read.csv('../external_data//massKushal.csv');
bodymass_val <- bodymass_data[,2];
bodymass_birds <- bodymass_data[,1];
match(bird_species,bodymass_birds)
bodymass_birds[1]
match(bodymass_birds[1], bird_species)
bird_species[1]
length(bird_species)
bird_species
new_counts[1:5,1:5]
colnames(data)
data[1:5,1:5]
data[1:5,1]
colnames(counts)
data=read.csv("../external_data/Himalayan_grid_matrix.csv",header=TRUE);
counts=as.matrix(data[,-1]);
rownames(counts)=data[,1];
counts[1:5,1:5]
new_data1 <- data.frame(read.csv('../external_data/MohanGrids.csv'));
new_data2 <- data.frame(read.csv('../external_data/MohanGrids2.csv'));
bird_species <- union(as.vector(colnames(counts)), union(as.vector(new_data1[,1]), as.vector(new_data2[,1])));
new_data <- matrix(0,dim(counts)[1]+3,length(bird_species));
new_data[1,match(new_data1[,1],bird_species)]=new_data1[,2];
new_data[2,match(new_data1[,1],bird_species)]=new_data1[,3];
new_data[3,match(new_data2[,1],bird_species)]=new_data2[,2];
new_data[4:(dim(counts)[1]+3),match(colnames(counts),bird_species)]=counts;
new_counts <- as.matrix(new_data);
rownames(new_counts) <- c(c("U1","U2","MA1"),rownames(counts));
bodymass_data <- read.csv('../external_data//massKushal.csv');
bodymass_val <- bodymass_data[,2];
bodymass_birds <- bodymass_data[,1];
match(bird_species,bodymass_birds)
bodymass_matched <- bodymass_data[match(bird_species,bodymass_birds),2];
length(bodymass_matched)
dim(new_counts)
new_counts %*% bodymass_matched
new_counts_bodymass <- sweep(new_counts,MARGIN=2,bodymass_matched,`*`)
new_counts[,1]
new_counts_bodymass[,1]
bodymass_birds[36]
bodymass_matched[36]
bodymass_matched[1]
dim(new_counts_bodymass)
min(bodymass_matched)
new_counts_bodymass <- sweep(new_counts,MARGIN=2,log(bodymass_matched),`*`)
new_counts_bodymass <- round(new_counts_bodymass);
for(k in 2:8)
{
Topic_Clus=topics(new_counts_bodymass,k,kill=0,tol=0.0001);
omega <- Topic_Clus$omega;
rownames(omega) <- rownames(new_counts);
theta <- Topic_Clus$theta;
rownames(theta) <- bird_species;
write.table(omega, paste0('../derived_data/bodymass_data/Topic_omega_clus',k,'.txt'));
write.table(theta, paste0('../derived_data/bodymass_data/Topic_theta_clus',k,'.txt'));
}
new_counts_bodymass[1:5,1:5]
counts[1:5,1:5]
new_counts[1:5,1:5]
new_counts[1:10,1:10]
new_counts_bodymass[1:10,1:10]
y=5
data <- data.frame(read_csv(paste0('/Users/kushal/Documents/Matthew Stephens Project/Alex Bird Data/external_data/counts_data_past/grids',years,'.csv')));
counts=as.matrix(data[,-1]);
rownames(counts)=data[,1];
new_data1 <- data.frame(read.csv('../external_data/MohanGrids.csv'));
new_data2 <- data.frame(read.csv('../external_data/MohanGrids2.csv'));
bird_species <- union(as.vector(colnames(counts)), union(as.vector(new_data1[,1]), as.vector(new_data2[,1])));
new_data <- matrix(0,dim(counts)[1]+3,length(bird_species));
new_data[1,match(new_data1[,1],bird_species)]=new_data1[,2];
new_data[2,match(new_data1[,1],bird_species)]=new_data1[,3];
new_data[3,match(new_data2[,1],bird_species)]=new_data2[,2];
new_data[4:(dim(counts)[1]+3),match(colnames(counts),bird_species)]=counts;
new_counts <- as.matrix(new_data);
rownames(new_counts) <- c(c("U1","U2","MA1"),rownames(counts));
dim(new_counts)
dim(data)
years <- 15
data <- data.frame(read_csv(paste0('/Users/kushal/Documents/Matthew Stephens Project/Alex Bird Data/external_data/counts_data_past/grids',years,'.csv')));
suppressMessages(suppressWarnings(library(readr)))
data <- data.frame(read_csv(paste0('/Users/kushal/Documents/Matthew Stephens Project/Alex Bird Data/external_data/counts_data_past/grids',years,'.csv')));
dim(data)
counts=as.matrix(data[,-1]);
rownames(counts)=data[,1];
new_data1 <- data.frame(read.csv('../external_data/MohanGrids.csv'));
new_data2 <- data.frame(read.csv('../external_data/MohanGrids2.csv'));
bird_species <- union(as.vector(colnames(counts)), union(as.vector(new_data1[,1]), as.vector(new_data2[,1])));
new_data <- matrix(0,dim(counts)[1]+3,length(bird_species));
new_data[1,match(new_data1[,1],bird_species)]=new_data1[,2];
new_data[2,match(new_data1[,1],bird_species)]=new_data1[,3];
new_data[3,match(new_data2[,1],bird_species)]=new_data2[,2];
new_data[4:(dim(counts)[1]+3),match(colnames(counts),bird_species)]=counts;
new_counts <- as.matrix(new_data);
rownames(new_counts) <- c(c("U1","U2","MA1"),rownames(counts));
dim(new_counts)
setwd("~/")
setwd("~/Documents/count-clustering/project/src")
deng_topics <- get(load("../rdas/deng_topic_fit.rda"))
deng_topics[[4]]$omega
deng_topics[[5]]$omega
dim(deng_topics[[5]]$omega)
top_features <- ExtractTopFeatures(theta_mat, top_features=10, "poisson");
library(CountClust)
top_features <- ExtractTopFeatures(theta_mat, top_features=10, "poisson");
theta_mat <- deng_topics[[5]]$theta;
top_features <- ExtractTopFeatures(theta_mat, top_features=10, "poisson");
top_features
theta_mat[1:5,1:5]
gene_names <- rownames(theta_mat);
gene_names
gene_names[top_features]
gene_list <- apply(1:dim(top_features)[1], 1, function(x) gene_names[top_features[x,]])
1:dim(top_features)[1]
top_features[x,]
top_features[1,]
gene_names[top_features[1,]]
gene_list <- do.call(rbind, lapply(1:dim(top_features)[1], 1, function(x) gene_names[top_features[x,]]))
lapply(1:dim(top_features)[1], 1, function(x) gene_names[top_features[x,]])
gene_list <- do.call(rbind, lapply(1:dim(top_features)[1], function(x) gene_names[top_features[x,]]))
gene_list
out <- queryMany(gene_list[1,],  scopes="name", fields=c("summary"), species="mouse");
out <- mygene::queryMany(gene_list[1,],  scopes="name", fields=c("summary"), species="mouse");
out
out <- mygene::queryMany(gene_list[1,],  scopes="symbol", fields=c("name", "summary"), species="mouse");
out
out[1,]
out[2,]
out <- mygene::queryMany(gene_list[2,],  scopes="symbol", fields=c("name", "summary"), species="mouse");
out
out <- mygene::queryMany(gene_list[3,],  scopes="symbol", fields=c("name", "summary"), species="mouse");
out
gene_list
